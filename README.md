# brave-taiwanese

## 專案簡介 / Project Overview

Brave Taiwanese 是一個針對戰爭或災害時通訊中斷情境設計的「離線災害協作地圖平台」。
主要功能包含離線地圖、災情/熱點上報、避難所查詢、臨時通訊、去中心化協作、權限管理等。

Brave Taiwanese is an offline disaster collaboration map platform designed for scenarios where communication is disrupted due to war or natural disasters. Key features include offline maps, incident/hotspot reporting, shelter lookup, ad-hoc communication, decentralized collaboration, and permission management.

---

## 安裝與啟動 / Installation & Getting Started

**中文**

1. 複製本專案到本地
2. 安裝依賴：`npm install` 或 `pnpm install`
3. 啟動開發伺服器：`npm run dev` 或 `pnpm dev`
4. 設定 `.env` 檔案（如需連接 Supabase 等服務，請參考 `src/lib/supabase.ts`）

**English**

1. Clone this repository
2. Install dependencies: `npm install` or `pnpm install`
3. Start the development server: `npm run dev` or `pnpm dev`
4. Configure `.env` file (for Supabase and other services, see `src/lib/supabase.ts`)

---

## 主要功能 / Key Features

-   離線地圖與 GPS 定位 / Offline map & GPS positioning
-   熱點上報與查詢 / Hotspot reporting & lookup
-   避難所、物資點查詢 / Shelter & supply point lookup
-   多語系支援 / Multi-language support
-   臨時通訊（去中心化/P2P）/ Ad-hoc (decentralized/P2P) communication
-   通知推播 / Notification system
-   權限分級 / Permission management
-   後台管理 / Backend management

---

## 開發規範與 .cursor/rules、.cursor/templates 使用說明

## Development Workflow: How to Use `.cursor/rules` & `.cursor/templates`

### 中文說明

本專案採用 cursor agent 智能協作開發流程，所有規則（rules）與範本（templates）皆由 cursor agent 依據 .mdc 文件自動協助產生與管理，開發者無需手動複製或調整。

#### 標準開發流程

1. **初始化專案：建立 PRD**
    - 參考：`.cursor/rules/workflows/workflow-agile-manual.mdc` 與 `pm.mdc`
    - 步驟：
        - 在專案根目錄下建立 `.ai/prd.md`，並用 `.cursor/templates/template-prd.md` 作為格式。
        - 仔細填寫需求、目標、解決的問題、技術決策、架構草圖（可用 mermaid 畫圖）、未知事項與風險。
        - 你就是「用戶」也是「PM」，所以自己審查內容是否足夠清楚、完整，並主動修正。
2. **撰寫架構文件**
    - 參考：`.cursor/rules/workflows/workflow-agile-manual.mdc` 與 `pm.mdc`
    - 步驟：
        - PRD 完善後，建立 `.ai/arch.md`（架構文件），模板參考 `.cursor/templates/template-arch.md`。
        - 描述具體架構設計、模組劃分、關鍵技術選型，補上架構圖。
        - 再次自我審查，確認內容完整且與 PRD 一致。
3. **制定開發故事（Story）**
    - 參考：`.cursor/rules/workflows/dev.mdc`
    - 步驟：
        - 針對每一個功能或需求，建立一個 `.ai/story-1.story.md`（或 `task-1.story.md`），用 `.cursor/templates/template-story.md` 作為範本。
        - 清楚記錄要開發的目標、子任務（subtasks）、驗收標準（AC）、每個步驟的討論或思考過程（chat log）。
        - 只有一個故事在進行中，完成後再寫下一個。
4. **開發與測試**
    - 參考：`.cursor/rules/workflows/dev.mdc`
    - 步驟：
        - 按故事中的任務逐步實作，每完成一步都更新故事文件。
        - 嚴格執行 TDD，先寫測試、再寫功能、讓測試通過。
        - 每次想法有變動、遇到困難、做出決策，都記錄在該故事的 chat log。
        - 全部故事的測試都跑過且通過，故事才算完成。
5. **持續回顧與完善**
    - 參考：全部規則
    - 步驟：
        - 完成一個故事後，回頭檢查是否有遺漏、是否符合 PRD 與架構初衷。
        - 修正檔案，然後再開始下一個故事循環。
        - 如果架構或需求有大變動，記得同步更新 `.ai/prd.md` 或 `.ai/arch.md`。

#### 實際舉例（流程摘要）

-   寫 PRD：我想做一個待辦清單工具，功能包含新增/刪除/標記完成。
-   寫架構：決定用 Python + Flask，資料存 SQLite，畫好 API 路由圖。
-   開第一個故事：實作「新增待辦」API，列出子任務：設計 API、寫資料庫邏輯、寫測試。
-   開發：每寫一段就更新故事檔案與測試，遇問題就記錄下來。
-   測試通過：故事更新為完成，開始新故事「刪除待辦」。
-   持續循環，專案越做越完整。

### English Instructions

This project uses the cursor agent for intelligent, automated workflow. All rules and templates are managed and generated by the agent based on .mdc files in the `.cursor/rules` and `.cursor/templates` folders. Developers do not manually copy or edit these files.

#### Standard Workflow

1. **Initialize Project: Create PRD**
    - Reference: `.cursor/rules/workflows/workflow-agile-manual.mdc` and `pm.mdc`
    - Steps:
        - Create `.ai/prd.md` in the project root, using `.cursor/templates/template-prd.md` as the format.
        - Carefully fill in requirements, goals, problems to solve, technical decisions, architecture sketches (use mermaid for diagrams), unknowns, and risks.
        - You are both "user" and "PM"—review and revise content for clarity and completeness.
2. **Write Architecture Document**
    - Reference: `.cursor/rules/workflows/workflow-agile-manual.mdc` and `pm.mdc`
    - Steps:
        - After PRD is complete, create `.ai/arch.md` (architecture doc), using `.cursor/templates/template-arch.md` as the template.
        - Describe concrete architecture, module division, key technology choices, and add architecture diagrams.
        - Review for completeness and consistency with PRD.
3. **Create Development Stories**
    - Reference: `.cursor/rules/workflows/dev.mdc`
    - Steps:
        - For each feature or requirement, create `.ai/story-1.story.md` (or `task-1.story.md`), using `.cursor/templates/template-story.md` as the template.
        - Clearly record development goals, subtasks, acceptance criteria (AC), and discussion/thought process (chat log).
        - Only one story is active at a time; start the next after completion.
4. **Development & Testing**
    - Reference: `.cursor/rules/workflows/dev.mdc`
    - Steps:
        - Implement tasks step by step, updating the story file after each.
        - Strictly follow TDD: write tests first, then code, ensure all tests pass.
        - Log all changes in thought, difficulties, and decisions in the story's chat log.
        - A story is only complete when all tests for all stories pass.
5. **Continuous Review & Improvement**
    - Reference: all rules
    - Steps:
        - After each story, check for omissions and alignment with PRD/architecture.
        - Fix files, then start the next story cycle.
        - If architecture or requirements change, update `.ai/prd.md` or `.ai/arch.md` accordingly.

#### Example Workflow

-   Write PRD: "I want to build a todo list tool with add/delete/mark complete."
-   Write architecture: Decide on Python + Flask, store data in SQLite, draw API route diagram.
-   First story: Implement "add todo" API, list subtasks: design API, write DB logic, write tests.
-   Development: Update story and tests after each step, log problems.
-   Tests pass: Mark story complete, start new story "delete todo".
-   Repeat, project becomes more complete.

---

## 聯絡方式 / Contact

如有任何問題，請聯繫專案負責人或在 issue 區留言。
If you have any questions, contact the project owner or open an issue.
